/**
 * Created by jonybang on 10.08.15.
 */
'use strict';

angular.module('app.persons')
        .factory('PersonEditor', ['$modal', '$q', function($modal, $q) {
            return function (inputs, person){
                if(person)
                    inputs.person_id = person.id;

                return $q(function(resolve, reject) {
                    var modalInstance = $modal.open({
                        animation: true,
                        templateUrl: '<%= asset_path('angular/modules/persons/templates/modals/form.html') %>',
                        controller: 'PersonsFormCtrl',
                        //size: size,
                        resolve: {
                            inputs: function(){
                                return inputs;
                            }
                        }
                    });

                    modalInstance.result.then(function (result) {
                        result.is_new = inputs.person_id ? false : true;
                        resolve(result);
                    }, function () {
                        reject('Cancel');
                    });
                });
            }
        }]);